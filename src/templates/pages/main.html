{% extends "pages/base.html" %}

{% block head %}
<title>Twitter</title>
{% endblock %}


{% block body %}


{% if 'user_id' in session %}
{% if session.get('user_role') == 'admin' %}
<div class="container" style="margin-top: 7%">

    <h3>Публикация</h3>

    <form action="/send_message" method="post">
        <div class="form-group">
            <label for="title">Название</label>
            <input type="text" name="title" required="true" class="form-control" aria-describedby="nameHelp"
                   placeholder="Текст названия">
            <!--        <small class="form-text text-muted">We'll never share your name with anyone else.</small>-->
        </div>

        <div class="form-group">
            <label for="text">Текст</label>
            <textarea class="form-control" name="text" required="true" rows="3"
                      placeholder="Текст публикации"></textarea>
        </div>

        <div class="form-group">
            <label for="tag">Теги</label>
            <input type="text" name="tag" required="true" class="form-control" placeholder="Ваши теги">
            <small class="form-text text-muted">Напиши теги через запятую.</small>
        </div>

        <button type="submit" class="btn btn-primary">Опубликовать</button>
    </form>
    <hr>
</div>
{% endif %}

{% endif %}
<div class="container">
    <h3>Твитты</h3>
    {% for message in messages %}
    <div class="card cardstyle">
        <div style="width:20%">
            <img id="card_avatar" src="https://randomuser.me/api/portraits/men/86.jpg" alt="Card image cap">
        </div>
        <div class="card-body">
            <h2 class="card-text">{{ message.user.name }} написал(а)</h2>
            <h5 class="card-title">{{ message.title }}</h5>
            <p class="card-text">{{ message.text }}</p>
            {% for tag in message.tags %}
            <a href='#{{ tag.text }}' class="badge badge-secondary">#{{ tag.text }}</a>
            {% endfor %}
        </div>
        <div class="card-footer text-muted">
            {% if session.get('user_role') == 'admin' %}
            <a href="#" class="btn btn-success">
                <i class="far fa-check-circle"></i>
            </a>
            <a href="#" class="btn btn-danger">
                <i class="far fa-times-circle"></i>
            </a>
            <a href="#" class="btn btn-warning">
                <i class="fas fa-pencil-alt"></i>
            </a>
            {% endif %}
            <p class="badge" style="float:right"><i class="far fa-calendar-alt"></i> {{ message.time }}</p>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}